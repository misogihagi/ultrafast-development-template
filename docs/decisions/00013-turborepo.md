## はじめに

- [決定](#決定)
- [ステータス](#ステータス)
- [背景](#背景)
- [想定される影響](#想定される影響)
- [検討した他の選択肢](#検討した他の選択肢)
- [参考文献](#参考文献)
- [結果](#結果)

## 決定

turborepoを使いモノレポ構成にする。

## ステータス

### <img src="https://raw.githubusercontent.com/FortAwesome/Font-Awesome/refs/heads/6.x/svgs/regular/circle-check.svg" width="10" alt="承認済み" /> 承認済み

## 背景

開発方法としてローカルで開発し、そこでできたものをクラウドに上げるというやり方をしてきた。
しかし、ローカルとクラウドではどうしても差が発生してしまうのもので、その差を頑張って埋めるか高いお金を出してローカルのものをクラウドで動かすかのどちらかのアプローチしかなかった。
現代は大クラウド時代。クラウドを使いこなせないものから淘汰されていく。
クラウドを使いこなすためにはどれだけ差を埋めるかが鍵となる。
そこで、採用したのがローカルでもクラウドでも変わらないところを増やし、差が出る部分はそれはそれで残し、どこで問題があるのかを最小限に留める方法。
細かくモジュールに切り出していくのだが、それをするにはモノレポが都合が良かった。
特にturborepoとpnpmは相性が良い。

### モノレポのメリット

1. コードの共有と再利用が容易になる

複数のプロジェクトで共通して利用するコンポーネントやライブラリがある場合、モノレポではそれを1つの場所に置くことができます。これにより、プロジェクト間でコードを簡単に共有し、再利用することが可能になります。変更を加える際も、1箇所を修正するだけでよいため、重複したコードのメンテナンスコストを削減できます。

2. アトミックな変更が可能になる

関連する複数のプロジェクトにまたがる変更を、1つのコミットで完結させることができます。たとえば、共通ライブラリのAPIを変更し、それを使用するすべてのアプリケーションを同時に更新するといった作業が、1つのコミットで安全に行えます。これは、マイクロレポ（複数のリポジトリ）で作業する場合に生じがちな、バージョン管理の不整合や依存関係の問題を防ぐのに役立ちます。

3. 依存関係の管理がシンプルになる

モノレポ内のすべてのプロジェクトが同じバージョンの依存関係（パッケージ）を使用するように強制しやすくなります。これにより、「依存関係の地獄（dependency hell）」として知られる問題、つまり、異なるプロジェクト間で依存するパッケージのバージョンが異なり、互換性の問題が発生する状況を避けることができます。

4. 大規模なリファクタリングがしやすくなる

リポジトリ全体を対象とした検索やリファクタリングが容易になります。特定の変数名や関数名を変更する場合でも、モノレポ内のすべてのプロジェクトに対して一括で変更を適用できるため、作業効率が向上します。

### モノレポのデメリット

1. リポジトリのサイズが大きくなる

すべてのプロジェクトの履歴とファイルが1つのリポジトリに含まれるため、リポジトリのサイズが非常に大きくなることがあります。これにより、クローンやフェッチといった操作に時間がかかる場合があります。

2. CI/CDの複雑さ

モノレポ内の特定のプロジェクトだけに変更があった場合でも、ビルドやテストを効率的に実行するための工夫が必要になります。変更があったプロジェクトだけをビルドする「インクリメンタルビルド」の設定など、CI/CDパイプラインの構築が複雑になることがあります。

3. アクセス制御の難しさ

リポジトリ全体に対するアクセス権限が与えられるため、プロジェクトごとにアクセスを厳密に制限するのが難しくなります。セキュリティ上の要件が厳しい場合には、この点が問題となることがあります。

## 想定される影響

<!-- この変更によって、何が簡単になり、何が難しくなるか？ -->

## 検討した他の選択肢

<!-- 後から他の選択肢を考慮したか、気にする必要がないように書いておく -->

## 参考文献

<!-- この変更の参考となった資料 -->

## 結果

<!-- この変更によって、もたらされた結果を後で書き込む -->
